<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Syntax (dreamtt.Core__.Syntax)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">dreamtt</a> &#x00BB; <a href="../index.html">Core__</a> &#x00BB; Syntax</nav><h1>Module <code>Core__.Syntax</code></h1><nav class="toc"><ul><li><a href="#core-language-representations">Core language representations</a><ul><li><a href="#logical-layer">Logical layer</a></li><li><a href="#representation-of-types">Representation of types</a></li><li><a href="#representation-of-terms">Representation of terms</a></li></ul></li><li><a href="#convenience">Convenience</a><ul><li><a href="#glued-terms">Glued terms</a></li><li><a href="#restricting-to-partial-elements">Restricting to partial elements</a></li><li><a href="#projecting-boundaries">Projecting boundaries</a></li></ul></li></ul></nav></header><aside><p>The core language syntax representation</p></aside><section><header><h2 id="core-language-representations"><a href="#core-language-representations" class="anchor"></a>Core language representations</h2><p>The core language syntax is split into two representations, after Coquand: a local form that is sensitive to the context (using De Bruijn indices), and a global form that is insensitive to the context (using De Bruijn levels).</p><p>The &quot;local&quot; syntax corresponds to ordinary syntax, and the &quot;global&quot; syntax corresponds to weak head normal forms in many NbE-style implementations. We make no attempt to restrict local syntax to normal forms; unlike conventional implementation, we freely interleave the local and the global syntax when it saves us some computations (see the annotations on <a href="index.html#type-ltm.LLam"><code>LLam</code></a> and <a href="index.html#type-ltm.LRcd"><code>LRcd</code></a> for instance).</p></header><section><header><h3 id="logical-layer"><a href="#logical-layer" class="anchor"></a>Logical layer</h3></header><dl><dt class="spec type" id="type-prop"><a href="#type-prop" class="anchor"></a><code><span class="keyword">type</span> <span>'v prop</span></code><code> = </code><table class="variant"><tr id="type-prop.PVar" class="anchored"><td class="def constructor"><a href="#type-prop.PVar" class="anchor"></a><code>| </code><code><span class="constructor">PVar</span> <span class="keyword">of</span> <span class="type-var">'v</span></code></td></tr><tr id="type-prop.PTop" class="anchored"><td class="def constructor"><a href="#type-prop.PTop" class="anchor"></a><code>| </code><code><span class="constructor">PTop</span></code></td></tr><tr id="type-prop.PBot" class="anchored"><td class="def constructor"><a href="#type-prop.PBot" class="anchor"></a><code>| </code><code><span class="constructor">PBot</span></code></td></tr></table></dt><dt class="spec type" id="type-gprop"><a href="#type-gprop" class="anchor"></a><code><span class="keyword">type</span> gprop</code><code> = <span><a href="../../Core/Env/index.html#type-lvl">Core.Env.lvl</a> <a href="index.html#type-prop">prop</a></span></code></dt><dt class="spec type" id="type-lprop"><a href="#type-lprop" class="anchor"></a><code><span class="keyword">type</span> lprop</code><code> = <span><a href="../../Core/Env/index.html#type-ix">Core.Env.ix</a> <a href="index.html#type-prop">prop</a></span></code></dt></dl></section><section><header><h3 id="representation-of-types"><a href="#representation-of-types" class="anchor"></a>Representation of types</h3></header><dl><dt class="spec type" id="type-ltp"><a href="#type-ltp" class="anchor"></a><code><span class="keyword">type</span> ltp</code><code> = </code><table class="variant"><tr id="type-ltp.LPi" class="anchored"><td class="def constructor"><a href="#type-ltp.LPi" class="anchor"></a><code>| </code><code><span class="constructor">LPi</span> <span class="keyword">of</span> <a href="index.html#type-ltp">ltp</a> * <a href="index.html#type-ltp">ltp</a></code></td></tr><tr id="type-ltp.LRcdTp" class="anchored"><td class="def constructor"><a href="#type-ltp.LRcdTp" class="anchor"></a><code>| </code><code><span class="constructor">LRcdTp</span> <span class="keyword">of</span> <span>string list</span> * <a href="index.html#type-ltele">ltele</a></code></td></tr><tr id="type-ltp.LBool" class="anchored"><td class="def constructor"><a href="#type-ltp.LBool" class="anchor"></a><code>| </code><code><span class="constructor">LBool</span></code></td></tr><tr id="type-ltp.LAbortTp" class="anchored"><td class="def constructor"><a href="#type-ltp.LAbortTp" class="anchor"></a><code>| </code><code><span class="constructor">LAbortTp</span></code></td></tr><tr id="type-ltp.LTpVar" class="anchored"><td class="def constructor"><a href="#type-ltp.LTpVar" class="anchor"></a><code>| </code><code><span class="constructor">LTpVar</span> <span class="keyword">of</span> <a href="../../Core/Env/index.html#type-ix">Core.Env.ix</a></code></td></tr></table></dt><dt class="spec type" id="type-gtp"><a href="#type-gtp" class="anchor"></a><code><span class="keyword">and</span> gtp</code><code> = </code><table class="variant"><tr id="type-gtp.GPi" class="anchored"><td class="def constructor"><a href="#type-gtp.GPi" class="anchor"></a><code>| </code><code><span class="constructor">GPi</span> <span class="keyword">of</span> <a href="index.html#type-gfam">gfam</a></code></td></tr><tr id="type-gtp.GRcdTp" class="anchored"><td class="def constructor"><a href="#type-gtp.GRcdTp" class="anchor"></a><code>| </code><code><span class="constructor">GRcdTp</span> <span class="keyword">of</span> <span>string list</span> * <a href="index.html#type-gtele">gtele</a></code></td></tr><tr id="type-gtp.GBool" class="anchored"><td class="def constructor"><a href="#type-gtp.GBool" class="anchor"></a><code>| </code><code><span class="constructor">GBool</span></code></td></tr><tr id="type-gtp.GAbortTp" class="anchored"><td class="def constructor"><a href="#type-gtp.GAbortTp" class="anchor"></a><code>| </code><code><span class="constructor">GAbortTp</span></code></td></tr></table></dt><dt class="spec type" id="type-gfam"><a href="#type-gfam" class="anchor"></a><code><span class="keyword">and</span> gfam</code><code> = <a href="index.html#type-gtp">gtp</a> * <a href="index.html#type-ltp">ltp</a> * <a href="index.html#type-env">env</a></code></dt><dt class="spec type" id="type-gtele"><a href="#type-gtele" class="anchor"></a><code><span class="keyword">and</span> gtele</code><code> = </code><table class="variant"><tr id="type-gtele.GTlNil" class="anchored"><td class="def constructor"><a href="#type-gtele.GTlNil" class="anchor"></a><code>| </code><code><span class="constructor">GTlNil</span></code></td></tr><tr id="type-gtele.GTlCons" class="anchored"><td class="def constructor"><a href="#type-gtele.GTlCons" class="anchor"></a><code>| </code><code><span class="constructor">GTlCons</span> <span class="keyword">of</span> <a href="index.html#type-gtp">gtp</a> * <a href="index.html#type-ltele">ltele</a> * <a href="index.html#type-env">env</a></code></td></tr></table></dt><dt class="spec type" id="type-ltele"><a href="#type-ltele" class="anchor"></a><code><span class="keyword">and</span> ltele</code><code> = </code><table class="variant"><tr id="type-ltele.LTlNil" class="anchored"><td class="def constructor"><a href="#type-ltele.LTlNil" class="anchor"></a><code>| </code><code><span class="constructor">LTlNil</span></code></td></tr><tr id="type-ltele.LTlCons" class="anchored"><td class="def constructor"><a href="#type-ltele.LTlCons" class="anchor"></a><code>| </code><code><span class="constructor">LTlCons</span> <span class="keyword">of</span> <a href="index.html#type-ltp">ltp</a> * <a href="index.html#type-ltele">ltele</a></code></td></tr></table></dt></dl></section><section><header><h3 id="representation-of-terms"><a href="#representation-of-terms" class="anchor"></a>Representation of terms</h3></header><dl><dt class="spec type" id="type-ltm"><a href="#type-ltm" class="anchor"></a><code><span class="keyword">and</span> ltm</code><code> = </code><table class="variant"><tr id="type-ltm.LVar" class="anchored"><td class="def constructor"><a href="#type-ltm.LVar" class="anchor"></a><code>| </code><code><span class="constructor">LVar</span> <span class="keyword">of</span> <a href="../../Core/Env/index.html#type-ix">Core.Env.ix</a></code></td></tr><tr id="type-ltm.LTt" class="anchored"><td class="def constructor"><a href="#type-ltm.LTt" class="anchor"></a><code>| </code><code><span class="constructor">LTt</span></code></td></tr><tr id="type-ltm.LFf" class="anchored"><td class="def constructor"><a href="#type-ltm.LFf" class="anchor"></a><code>| </code><code><span class="constructor">LFf</span></code></td></tr><tr id="type-ltm.LLam" class="anchored"><td class="def constructor"><a href="#type-ltm.LLam" class="anchor"></a><code>| </code><code><span class="constructor">LLam</span> <span class="keyword">of</span> <a href="index.html#type-gfam">gfam</a> * <a href="index.html#type-ltm">ltm</a></code></td></tr><tr id="type-ltm.LApp" class="anchored"><td class="def constructor"><a href="#type-ltm.LApp" class="anchor"></a><code>| </code><code><span class="constructor">LApp</span> <span class="keyword">of</span> <a href="index.html#type-ltm">ltm</a> * <a href="index.html#type-ltm">ltm</a></code></td></tr><tr id="type-ltm.LRcd" class="anchored"><td class="def constructor"><a href="#type-ltm.LRcd" class="anchor"></a><code>| </code><code><span class="constructor">LRcd</span> <span class="keyword">of</span> <span>string list</span> * <a href="index.html#type-gtele">gtele</a> * <span><a href="index.html#type-ltm">ltm</a> <a href="../../Basis/index.html#module-StringMap">Basis.StringMap</a>.t</span></code></td></tr><tr id="type-ltm.LProj" class="anchored"><td class="def constructor"><a href="#type-ltm.LProj" class="anchor"></a><code>| </code><code><span class="constructor">LProj</span> <span class="keyword">of</span> string * <a href="index.html#type-ltm">ltm</a></code></td></tr><tr id="type-ltm.LAbort" class="anchored"><td class="def constructor"><a href="#type-ltm.LAbort" class="anchor"></a><code>| </code><code><span class="constructor">LAbort</span></code></td></tr></table></dt><dt class="spec type" id="type-gtm"><a href="#type-gtm" class="anchor"></a><code><span class="keyword">and</span> gtm</code><code> = </code><table class="variant"><tr id="type-gtm.GTt" class="anchored"><td class="def constructor"><a href="#type-gtm.GTt" class="anchor"></a><code>| </code><code><span class="constructor">GTt</span></code></td></tr><tr id="type-gtm.GFf" class="anchored"><td class="def constructor"><a href="#type-gtm.GFf" class="anchor"></a><code>| </code><code><span class="constructor">GFf</span></code></td></tr><tr id="type-gtm.GLam" class="anchored"><td class="def constructor"><a href="#type-gtm.GLam" class="anchor"></a><code>| </code><code><span class="constructor">GLam</span> <span class="keyword">of</span> <a href="index.html#type-gfam">gfam</a> * <a href="index.html#type-ltm">ltm</a> * <a href="index.html#type-env">env</a></code></td></tr><tr id="type-gtm.GRcd" class="anchored"><td class="def constructor"><a href="#type-gtm.GRcd" class="anchor"></a><code>| </code><code><span class="constructor">GRcd</span> <span class="keyword">of</span> <span>string list</span> * <a href="index.html#type-gtele">gtele</a> * <span><a href="index.html#type-gtm">gtm</a> <a href="../../Basis/index.html#module-StringMap">Basis.StringMap</a>.t</span></code></td></tr><tr id="type-gtm.Glued" class="anchored"><td class="def constructor"><a href="#type-gtm.Glued" class="anchor"></a><code>| </code><code><span class="constructor">Glued</span> <span class="keyword">of</span> <span><span>(<a href="index.html#type-gneu">gneu</a>, <a href="index.html#type-ltm">ltm</a>)</span> <a href="index.html#type-glued">glued</a></span></code></td></tr><tr id="type-gtm.GAbort" class="anchored"><td class="def constructor"><a href="#type-gtm.GAbort" class="anchor"></a><code>| </code><code><span class="constructor">GAbort</span></code></td></tr></table></dt><dt class="spec type" id="type-gneu"><a href="#type-gneu" class="anchor"></a><code><span class="keyword">and</span> gneu</code><code> = </code><table class="variant"><tr id="type-gneu.GVar" class="anchored"><td class="def constructor"><a href="#type-gneu.GVar" class="anchor"></a><code>| </code><code><span class="constructor">GVar</span> <span class="keyword">of</span> <a href="../../Core/Env/index.html#type-lvl">Core.Env.lvl</a></code></td></tr><tr id="type-gneu.GSnoc" class="anchored"><td class="def constructor"><a href="#type-gneu.GSnoc" class="anchor"></a><code>| </code><code><span class="constructor">GSnoc</span> <span class="keyword">of</span> <a href="index.html#type-gneu">gneu</a> * <a href="index.html#type-gfrm">gfrm</a></code></td></tr></table></dt><dt class="spec type" id="type-gfrm"><a href="#type-gfrm" class="anchor"></a><code><span class="keyword">and</span> gfrm</code><code> = </code><table class="variant"><tr id="type-gfrm.GProj" class="anchored"><td class="def constructor"><a href="#type-gfrm.GProj" class="anchor"></a><code>| </code><code><span class="constructor">GProj</span> <span class="keyword">of</span> string</code></td></tr><tr id="type-gfrm.GApp" class="anchored"><td class="def constructor"><a href="#type-gfrm.GApp" class="anchor"></a><code>| </code><code><span class="constructor">GApp</span> <span class="keyword">of</span> <a href="index.html#type-gtm">gtm</a></code></td></tr></table></dt></dl><aside><p>A glued term combines a total element <span class="xref-unresolved" title="unresolved reference to &quot;glued.base&quot;"><a href="index.html#type-glued"><code>glued</code></a>.base</span> with a compatible partial element <span class="xref-unresolved" title="unresolved reference to &quot;glued.part&quot;"><a href="index.html#type-glued"><code>glued</code></a>.part</span> under <span class="xref-unresolved" title="unresolved reference to &quot;glued.supp&quot;"><a href="index.html#type-glued"><code>glued</code></a>.supp</span>; the invariant is that when <span class="xref-unresolved" title="unresolved reference to &quot;glued.supp&quot;"><a href="index.html#type-glued"><code>glued</code></a>.supp</span> is true, <span class="xref-unresolved" title="unresolved reference to &quot;glued.base&quot;"><a href="index.html#type-glued"><code>glued</code></a>.base</span> shall have destabilized to carry no semantic information. The main use-case is when <span class="xref-unresolved" title="unresolved reference to &quot;glued.base&quot;"><a href="index.html#type-glued"><code>glued</code></a>.base</span> is a neutral that must compute under <span class="xref-unresolved" title="unresolved reference to &quot;glued.supp&quot;"><a href="index.html#type-glued"><code>glued</code></a>.supp</span> to the element determined by <span class="xref-unresolved" title="unresolved reference to &quot;glued.part&quot;"><a href="index.html#type-glued"><code>glued</code></a>.part</span>.</p></aside><dl><dt class="spec type" id="type-glued"><a href="#type-glued" class="anchor"></a><code><span class="keyword">and</span> <span>('b, 'a) glued</span></code><code> = </code><table class="variant"><tr id="type-glued.Gl" class="anchored"><td class="def constructor"><a href="#type-glued.Gl" class="anchor"></a><code>| </code><code><span class="constructor">Gl</span> <span class="keyword">of</span> </code><code>{</code><table class="record"><tr id="type-glued.supp" class="anchored"><td class="def field"><a href="#type-glued.supp" class="anchor"></a><code>supp : <a href="index.html#type-gprop">gprop</a>;</code></td></tr><tr id="type-glued.gtp" class="anchored"><td class="def field"><a href="#type-glued.gtp" class="anchor"></a><code>gtp : <a href="index.html#type-gtp">gtp</a>;</code></td></tr><tr id="type-glued.base" class="anchored"><td class="def field"><a href="#type-glued.base" class="anchor"></a><code>base : <span class="type-var">'b</span>;</code></td></tr><tr id="type-glued.part" class="anchored"><td class="def field"><a href="#type-glued.part" class="anchor"></a><code>part : <span class="type-var">'a</span>;</code></td></tr><tr id="type-glued.env" class="anchored"><td class="def field"><a href="#type-glued.env" class="anchor"></a><code>env : <a href="index.html#type-env">env</a>;</code></td></tr></table><code>}</code></td></tr></table></dt><dt class="spec type" id="type-part"><a href="#type-part" class="anchor"></a><code><span class="keyword">and</span> <span>'a part</span></code><code> = </code><table class="variant"><tr id="type-part.Prt" class="anchored"><td class="def constructor"><a href="#type-part.Prt" class="anchor"></a><code>| </code><code><span class="constructor">Prt</span> <span class="keyword">of</span> </code><code>{</code><table class="record"><tr id="type-part.supp" class="anchored"><td class="def field"><a href="#type-part.supp" class="anchor"></a><code>supp : <a href="index.html#type-gprop">gprop</a>;</code></td></tr><tr id="type-part.part" class="anchored"><td class="def field"><a href="#type-part.part" class="anchor"></a><code>part : <span class="type-var">'a</span>;</code></td></tr><tr id="type-part.env" class="anchored"><td class="def field"><a href="#type-part.env" class="anchor"></a><code>env : <a href="index.html#type-env">env</a>;</code></td></tr></table><code>}</code></td></tr></table></dt><dt class="spec type" id="type-env"><a href="#type-env" class="anchor"></a><code><span class="keyword">and</span> env</code><code> = <span><a href="index.html#type-cell">cell</a> <a href="../../Core/Env/index.html#type-t">Core.Env.t</a></span></code></dt><dt class="spec type" id="type-cell"><a href="#type-cell" class="anchor"></a><code><span class="keyword">and</span> cell</code> = <code>[ </code><table class="variant"><tr id="type-cell.Tm" class="anchored"><td class="def constructor"><a href="#type-cell.Tm" class="anchor"></a><code>| </code><code>`Tm <span class="keyword">of</span> <a href="index.html#type-gtm">gtm</a></code></td></tr><tr id="type-cell.Tp" class="anchored"><td class="def constructor"><a href="#type-cell.Tp" class="anchor"></a><code>| </code><code>`Tp <span class="keyword">of</span> <a href="index.html#type-gtp">gtp</a></code></td></tr><tr id="type-cell.Prop" class="anchored"><td class="def constructor"><a href="#type-cell.Prop" class="anchor"></a><code>| </code><code>`Prop <span class="keyword">of</span> <a href="index.html#type-gprop">gprop</a></code></td></tr></table><code> ]</code></dt></dl></section></section><section><header><h2 id="convenience"><a href="#convenience" class="anchor"></a>Convenience</h2></header><dl><dt class="spec type" id="type-tp_head"><a href="#type-tp_head" class="anchor"></a><code><span class="keyword">type</span> tp_head</code> = <code>[ </code><table class="variant"><tr id="type-tp_head.Pi" class="anchored"><td class="def constructor"><a href="#type-tp_head.Pi" class="anchor"></a><code>| </code><code>`Pi</code></td></tr><tr id="type-tp_head.Rcd" class="anchored"><td class="def constructor"><a href="#type-tp_head.Rcd" class="anchor"></a><code>| </code><code>`Rcd <span class="keyword">of</span> <span>string list</span></code></td></tr><tr id="type-tp_head.Bool" class="anchored"><td class="def constructor"><a href="#type-tp_head.Bool" class="anchor"></a><code>| </code><code>`Bool</code></td></tr><tr id="type-tp_head.Abort" class="anchored"><td class="def constructor"><a href="#type-tp_head.Abort" class="anchor"></a><code>| </code><code>`Abort</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-tp_head"><a href="#val-tp_head" class="anchor"></a><code><span class="keyword">val</span> tp_head : <a href="index.html#type-gtp">gtp</a> <span>&#45;&gt;</span> <a href="index.html#type-tp_head">tp_head</a></code></dt><dd><p>Project the name of the head constructor of a type; useful for guiding elaboration.</p></dd></dl><dl><dt class="spec value" id="val-tp_of_gtm"><a href="#val-tp_of_gtm" class="anchor"></a><code><span class="keyword">val</span> tp_of_gtm : <a href="index.html#type-gtm">gtm</a> <span>&#45;&gt;</span> <a href="index.html#type-gtp">gtp</a></code></dt><dd><p>Project the type of a term: this is efficient and non-recursive.</p></dd></dl><section><header><h4 id="glued-terms"><a href="#glued-terms" class="anchor"></a>Glued terms</h4></header><dl><dt class="spec value" id="val-glued_to_part"><a href="#val-glued_to_part" class="anchor"></a><code><span class="keyword">val</span> glued_to_part : <span><span>(<span class="type-var">'b</span>, <span class="type-var">'a</span>)</span> <a href="index.html#type-glued">glued</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-part">part</a></span></code></dt><dd><p>Project the partial element from a glued term.</p></dd></dl><dl><dt class="spec value" id="val-stable_glued"><a href="#val-stable_glued" class="anchor"></a><code><span class="keyword">val</span> stable_glued : <a href="index.html#type-gtp">gtp</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>, <a href="index.html#type-ltm">ltm</a>)</span> <a href="index.html#type-glued">glued</a></span></code></dt><dd><p>Construct a stable glued term, i.e. one form whom the base is nowhere unstable.</p></dd></dl></section><section><header><h4 id="restricting-to-partial-elements"><a href="#restricting-to-partial-elements" class="anchor"></a>Restricting to partial elements</h4></header><dl><dt class="spec value" id="val-gtm_to_part"><a href="#val-gtm_to_part" class="anchor"></a><code><span class="keyword">val</span> gtm_to_part : <a href="index.html#type-gprop">gprop</a> <span>&#45;&gt;</span> <a href="index.html#type-gtm">gtm</a> <span>&#45;&gt;</span> <span><a href="index.html#type-ltm">ltm</a> <a href="index.html#type-part">part</a></span></code></dt><dd><p>Restrict a total term to a partial term.</p></dd></dl><dl><dt class="spec value" id="val-gtp_to_part"><a href="#val-gtp_to_part" class="anchor"></a><code><span class="keyword">val</span> gtp_to_part : <a href="index.html#type-gprop">gprop</a> <span>&#45;&gt;</span> <a href="index.html#type-gtp">gtp</a> <span>&#45;&gt;</span> <span><a href="index.html#type-ltp">ltp</a> <a href="index.html#type-part">part</a></span></code></dt><dd><p>Restrict a total type to a partial type.</p></dd></dl></section><section><header><h4 id="projecting-boundaries"><a href="#projecting-boundaries" class="anchor"></a>Projecting boundaries</h4><p>The following functions project the partial (terms, types) that a (term, type) must compute to; when the input has a stable head constructor, the empty partial element is returned.</p></header><dl><dt class="spec value" id="val-gtm_bdry"><a href="#val-gtm_bdry" class="anchor"></a><code><span class="keyword">val</span> gtm_bdry : <a href="index.html#type-gtm">gtm</a> <span>&#45;&gt;</span> <span><a href="index.html#type-ltm">ltm</a> <a href="index.html#type-part">part</a></span></code></dt><dt class="spec value" id="val-gtp_bdry"><a href="#val-gtp_bdry" class="anchor"></a><code><span class="keyword">val</span> gtp_bdry : <a href="index.html#type-gtp">gtp</a> <span>&#45;&gt;</span> <span><a href="index.html#type-ltp">ltp</a> <a href="index.html#type-part">part</a></span></code></dt></dl></section></section></div></body></html>